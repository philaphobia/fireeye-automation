package com.phkcyber.fireeyeautomation.pojo;

import java.util.Date;
import java.util.List;

import com.google.gson.annotations.SerializedName;

import com.phkcyber.fireeyeautomation.common.Common;

public class MalwareObject {
	public enum ALERT_METADATA {
		OBJECT_TYPE,
		FILE_PATH,
		MODIFICATION_TIME,
		MD5SUM,
		INFECTION_NAME,
		INFECTION_TYPE,
		APPLIED_ACTION,
		TIMESTAMP
	}
	
	public String msg;
	public String product;
	public Alert alert;
	public String version;
	@SerializedName("appliance-id")
	public String applianceId;
	public String appliance;

	
	public class Alert {
		public String _id;
		public Host host;
		public String matched_at;
		public Event event_values;
		public String event_type;
		public String reported_at;
		public String resolution;
		public String event_at;
		public String source;
		public Explanation explanation;
		//public List <MatchedSourceAlerts> matched_source_alerts;
		public String event_id;
		public String name;
		public Host src;
		public Host dst;
		
		
		public class Event {
			public Detections detections;
			
			public class Detections {
				public List<Detection> detection;
			}
			
			public class Detection {
				//public Engine engine;
				@SerializedName("infected-object")
				public InfectedObject infected_object;
				public Infection infection;
				public Action action;
				
				@SerializedName("requested-action")
				public String requested_action;
				@SerializedName("applied-action")
				public String applied_action;
				public String result;
				public String error;
				@SerializedName("reboot-required")
				public String reboot_required;
						
				public class InfectedObject {
					@SerializedName("object-type")
					public String object_type;
					@SerializedName("file-object")
					public FileObject file_object;
					

				}
				
				public class Infection {
					@SerializedName("confidence-level")
					public String confidence_level;
					@SerializedName("infection-type")
					public String infection_type;
					@SerializedName("infection-name")
					public String infection_name;
				}
				
				public class Action {
					@SerializedName("actioned-object")
					public ActionedObject actioned_object;
					@SerializedName("applied-action")
					public String applied_action;
					
					public class ActionedObject {
						@SerializedName("object-type")
						public String object_type;
						@SerializedName("file-object")
						public FileObject file_object;
					}
				}
				
				public class FileObject {
					@SerializedName("file-path")
					public String file_path;
					@SerializedName("modification-time")
					public String modification_time;
					public String packed;
					public String hidden;
					@SerializedName("size-in-bytes")
					public String size_in_bytes;
					public String md5sum;
					@SerializedName("creation-time")
					public String creation_time;
					@SerializedName("access-time")
					public String access_time;
				}
			}
		}
		
	
		public class Host {
			public String os;
			public String hostname;
			public String host;
			public String ip;
			public String port;
			public String mac;
			public String agent_id;
			public String agent_version;
		}
		
		public class Explanation {
			@SerializedName("malware-detected")
			public MalwareDetected malwaredetected;
			@SerializedName("cnc-services")
			public CncServices cncservices;
			public String protocol;
			public String analysis;
			
			public class MalwareDetected {
				public Malware malware;
				
				public class Malware {
					public String name;
					public String stype;
					public String sid;
					@SerializedName("http-header")
					public String http_header;
					@SerializedName("executed-at")
					public String executed_at;
					public String md5sum;
				}
			}
			
			public class CncServices {
				@SerializedName("cnc-service")
				public CncService cncservice;
				
				public class CncService {
					public String sname;
					String protocol;
					public String url;
					String address;
					String host;
					String side;
					public String type;
					String port;
					public String channel;
				}
			}
		}
		
		public class Interface {
			String iface;
			String mode;
			String label;
		}
		
		public Date getOccurred() {
			return( Common.parseDates(this.matched_at) );
		}
		

	}//Alert
	
}
